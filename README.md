# FBHash : A New Similarity Hashing Scheme for Digital Forensics 
## [D. Chang et al. / Digital Investigation 29 (2019) S113eS123]

This is an implementation of the mentioned paper. The core idea behind the FbHashing scheme is to identify frequently occuring
chunks in document and use it to find the similarity of the document with another document. In another terms, it is used to 
fingerprint a document to identify interesting pieces of information that will aid in digital forensic investigations. 

The whole process occurs as follows.
- Take two document of length N. For our ease of demonstration, I've added two simple data objects within the source code itself.
Each of them are 52 characters long and include only the uppercase and lowercase ASCII characters. 
- For each document do the following
- First find the chunks in a document. For that we slice the document into numerous pieces with length 7. Each new chunk is generated by removing the first character from the preceeding chunk and adding another one at the end from the document supplied. For example, if our document was ABCDEFGHIJKLM... then the first chunk will be ABCDEFG and the second one will be BCDEFGH and so on. 
- The chunks are then passed on to the Rabin-Karp Rolling Hash function. Here a unique hash of the chunks are calculated using the following equation : 

### H = C<sub>1</sub>*a<sup>(k-1)</sup> + C<sub>2</sub>*a<sup>(k-2)</sup> + C<sub>3</sub>*a<sup>(k-3)</sup> + ... + C<sub>k</sub>*a<sup>0</sup> modulus n
Where "a" is a constant, k is window size (chunk length), n is a large prime number, 

C<sub>1</sub>,C<sub>2</sub>,..,C<sub>k</sub> are the input characters (ASCII Values)

Hnew = ( a*H - C<sub>0</sub>*a<sup>k</sup> + incoming byte ) modulus n

EQN : RollingHash(Ch<sub>(i+1)</sub>) = a*RollingHash(Ch<sub>i</sub>) - C<sub>i</sub>*a<sup>k</sup> + C<sub>(i+k)</sub> modulus n

Max value of H can be an unsigned 64 bit number

All possible ASCII values of C<sub>i</sub> (input characters) = 256 (ASCII Value)

All possible values of "a" (constant) = 256 (size of alphabet)

Value of k should satisfy the following

   2<sup>64</sup> - 1 >= 256 * 256<sup>(k-1)</sup>

Let k = 7

   2<sup>64</sup> > 2<sup>8<sup> * (2<sup>8</sup>)<sup>6</sup> = 2<sup>56</sup>

- Using this list of chunks, filter out the unique chunks and find the chunk frequncy in the document. By chunk frequency we mean the number of times a chunk repeats itself within the same document. 
